/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { authCheckEmail } from "../funcs/authCheckEmail.js";
import { authForgotPassword } from "../funcs/authForgotPassword.js";
import { authGetCurrentUser } from "../funcs/authGetCurrentUser.js";
import { authGoogleCallback } from "../funcs/authGoogleCallback.js";
import { authGoogleRedirect } from "../funcs/authGoogleRedirect.js";
import { authLogin } from "../funcs/authLogin.js";
import { authLogout } from "../funcs/authLogout.js";
import { authRegister } from "../funcs/authRegister.js";
import { authResendVerificationEmail } from "../funcs/authResendVerificationEmail.js";
import { authResetPassword } from "../funcs/authResetPassword.js";
import { authUpdateUserInfo } from "../funcs/authUpdateUserInfo.js";
import { authVerifyEmail } from "../funcs/authVerifyEmail.js";
import { ClientSDK, RequestOptions } from "../lib/sdks.js";
import * as models from "../models/index.js";
import * as operations from "../models/operations/index.js";
import { unwrapAsync } from "../types/fp.js";

export class Auth extends ClientSDK {
  /**
   * Check if email exists
   *
   * @remarks
   * # Errors
   * Returns 404 if email doesn't exist, 204 if it does exist, or 500 for database errors.
   */
  async checkEmail(
    request: models.CheckEmailRequest,
    options?: RequestOptions,
  ): Promise<void> {
    return unwrapAsync(authCheckEmail(
      this,
      request,
      options,
    ));
  }

  /**
   * Forgot password
   *
   * @remarks
   * # Errors
   * Returns an error if database operations fail or email service fails.
   */
  async forgotPassword(
    request: models.ForgotPasswordRequest,
    options?: RequestOptions,
  ): Promise<models.ForgotPasswordResponse> {
    return unwrapAsync(authForgotPassword(
      this,
      request,
      options,
    ));
  }

  /**
   * Google `OAuth` redirect
   *
   * @remarks
   * # Errors
   * Returns an error if session operations fail or `OAuth` service configuration is invalid.
   */
  async googleRedirect(
    options?: RequestOptions,
  ): Promise<void> {
    return unwrapAsync(authGoogleRedirect(
      this,
      options,
    ));
  }

  /**
   * Google `OAuth` callback
   *
   * @remarks
   * # Errors
   * Returns an error if `OAuth` state verification fails, token exchange fails, or database operations fail.
   */
  async googleCallback(
    request: operations.GoogleAuthCallbackRequest,
    options?: RequestOptions,
  ): Promise<void> {
    return unwrapAsync(authGoogleCallback(
      this,
      request,
      options,
    ));
  }

  /**
   * User login
   *
   * @remarks
   * # Errors
   * Returns an error if credentials are invalid, email is not verified, or database operations fail.
   */
  async login(
    request: models.LoginRequest,
    options?: RequestOptions,
  ): Promise<models.LoginResponse> {
    return unwrapAsync(authLogin(
      this,
      request,
      options,
    ));
  }

  /**
   * Logout
   *
   * @remarks
   * # Errors
   * Returns an error if session operations fail.
   */
  async logout(
    security: operations.LogoutSecurity,
    options?: RequestOptions,
  ): Promise<models.LogoutResponse> {
    return unwrapAsync(authLogout(
      this,
      security,
      options,
    ));
  }

  /**
   * Get current user info
   *
   * @remarks
   * # Errors
   * Returns an error if user is not authenticated or serialization fails.
   */
  async getCurrentUser(
    security: operations.GetMeSecurity,
    options?: RequestOptions,
  ): Promise<models.UserInfo> {
    return unwrapAsync(authGetCurrentUser(
      this,
      security,
      options,
    ));
  }

  /**
   * Update user information
   *
   * @remarks
   * # Errors
   * Returns an error if database operations fail or user validation fails.
   */
  async updateUserInfo(
    security: operations.UpdateUserInfoSecurity,
    request: models.UpdateUserInfoRequest,
    options?: RequestOptions,
  ): Promise<models.UpdateUserInfoResponse> {
    return unwrapAsync(authUpdateUserInfo(
      this,
      security,
      request,
      options,
    ));
  }

  /**
   * User registration
   *
   * @remarks
   * # Errors
   * Returns an error if input validation fails, user already exists, or database operations fail.
   */
  async register(
    request: models.RegisterRequest,
    options?: RequestOptions,
  ): Promise<models.RegisterResponse> {
    return unwrapAsync(authRegister(
      this,
      request,
      options,
    ));
  }

  /**
   * Resend verification email
   *
   * @remarks
   * # Errors
   * Returns an error if user is already verified, database operations fail, or email service fails.
   */
  async resendVerificationEmail(
    security: operations.ResendVerificationEmailSecurity,
    options?: RequestOptions,
  ): Promise<models.ResendVerificationResponse> {
    return unwrapAsync(authResendVerificationEmail(
      this,
      security,
      options,
    ));
  }

  /**
   * Reset password
   *
   * @remarks
   * # Errors
   * Returns an error if token is invalid, password validation fails, or database operations fail.
   */
  async resetPassword(
    request: models.ResetPasswordRequest,
    options?: RequestOptions,
  ): Promise<models.ResetPasswordResponse> {
    return unwrapAsync(authResetPassword(
      this,
      request,
      options,
    ));
  }

  /**
   * Email verification
   *
   * @remarks
   * # Errors
   * Returns an error if token is invalid, expired, or database operations fail.
   */
  async verifyEmail(
    request: operations.VerifyEmailRequest,
    options?: RequestOptions,
  ): Promise<void> {
    return unwrapAsync(authVerifyEmail(
      this,
      request,
      options,
    ));
  }
}
